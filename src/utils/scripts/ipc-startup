#!/bin/bash
# Initialize ipcsystools for operation
#  - detecting the UMTS/LTE modem
#  - starting the initial connection
echo -n "Startup IPC environment... "

if which ipc-set-led  > /dev/null ; then
	/usr/bin/ipc-set-led all-off
fi

if [ -e /etc/ptxdist-version ] ; then
	/usr/share/ipcsystools/ipc-initsystem.sh
fi

# Initialize modem (apn, sim, ...)
. /usr/share/ipcsystools/ipclib.inc
InitializeModem

# Startup WAN connection	
if [ ! -e /etc/ipcsystools.disable ] ; then
	startup_wan_connection
	touch /var/run/ipcsystools.enabled
else
	echo -n "(ipcsystools disabled) "
	rm -f /var/run/ipcsystools.enabled
fi

if which ipc-set-led > /dev/null ; then
	ipc-set-led ready on
fi

echo "done."
exit 0
